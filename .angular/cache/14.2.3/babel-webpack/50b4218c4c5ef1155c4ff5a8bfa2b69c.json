{"ast":null,"code":"import _classCallCheck from \"C:/Users/nsuwanw/Desktop/smartlocker-sp/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/nsuwanw/Desktop/smartlocker-sp/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport { Router } from '@angular/router';\nimport { DataService } from '../data.service';\nimport { HttpClient } from '@angular/common/http';\nimport { TypeResponse } from 'src/app/shared/model';\nimport { delay } from 'q';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"../data.service\";\nexport var ReturnItemsComponent = /*#__PURE__*/(function () {\n  var ReturnItemsComponent = /*#__PURE__*/function () {\n    function ReturnItemsComponent(router, http, language) {\n      _classCallCheck(this, ReturnItemsComponent);\n\n      this.router = router;\n      this.http = http;\n      this.language = language;\n      this.serial_number = \"\";\n      this.locker_num = \"\";\n      this.locker_num_temp = \"\";\n      this.door_close = 1;\n      this.lang = \"\";\n    }\n\n    _createClass(ReturnItemsComponent, [{\n      key: \"ngOnInit\",\n      value: function ngOnInit() {\n        var _this = this;\n\n        this.language.currentLanguage.subscribe(function (message) {\n          _this.lang = message;\n\n          if (_this.lang == \"thai\") {\n            _this.tothai();\n          } else {\n            _this.toeng();\n          }\n        });\n      }\n    }, {\n      key: \"onkeydownHandler\",\n      value: function onkeydownHandler(event) {\n        var _this2 = this;\n\n        if (event.key === \"Enter\" && this.door_close == 1) {\n          console.log(this.serial_number);\n\n          if (this.lang == \"thai\") {\n            document.getElementById(\"ScanSerial\").innerHTML = \"กรุณารอซักครู่\";\n          } else {\n            document.getElementById(\"ScanSerial\").innerHTML = \"Processing, please wait\";\n          }\n\n          this.http.get('https://smartlocker20220922110147.azurewebsites.net/api/admin/barcode/' + this.serial_number).subscribe(function (data) {\n            detail = data;\n            console.log(detail);\n\n            if (detail != null && detail.loaner.employeeId != null) {\n              _this2.locker_num_temp = detail.locker.name.toString();\n              _this2.locker_num = _this2.locker_num_temp.substring(7);\n              console.log(\"locker number: \" + _this2.locker_num);\n\n              _this2.http.get(\"/lockers/open/\" + _this2.locker_num).subscribe(function (data) {\n                console.log(data);\n                _this2.door_close = 0;\n\n                if (_this2.lang == \"thai\") {\n                  document.getElementById(\"ScanSerial\").innerHTML = \"คืนอุปกรณ์แล้วปิดบานช่อง\";\n                } else {\n                  document.getElementById(\"ScanSerial\").innerHTML = \"Return the item and close the door.\";\n                }\n\n                _this2.checkLocker(_this2.locker_num);\n              });\n            } else {\n              // alert(this.serial_number+\" : Not found\");\n              // document.getElementById(\"ScanSerial\").innerHTML = this.serial_number+\" : Not found. Please Scan other item.\"; \n              if (_this2.lang == \"thai\") {\n                document.getElementById(\"ScanSerial\").innerHTML = \"ไม่พบข้อมูลอุปกรณ์ กรุณาอุปกรณ์อื่น\";\n              } else {\n                document.getElementById(\"ScanSerial\").innerHTML = \"Item not found. Please Scan other item\";\n              }\n\n              _this2.serial_number = \"\";\n            }\n          });\n        } else if (this.door_close == 1) {\n          if (\"Shift\".includes(event.key)) {} else if (\"/\".includes(event.key)) {\n            this.serial_number = this.serial_number + \"-\";\n          } else {\n            this.serial_number = this.serial_number + event.key;\n          }\n        }\n      }\n    }, {\n      key: \"checkLocker\",\n      value: function checkLocker(locker_num) {\n        var _this3 = this;\n\n        // console.log(\"ASSD\" + locker_num);\n        delay(3000);\n        this.http.get(\"/lockers/checkclose/\" + locker_num).subscribe(function (data) {\n          detail = data;\n\n          if (detail.result == 1) {\n            // alert(\"close\")\n            console.log('https://smartlocker20220922110147.azurewebsites.net/api/admin/return/' + _this3.serial_number);\n\n            _this3.http.get('https://smartlocker20220922110147.azurewebsites.net/api/admin/return/' + _this3.serial_number).subscribe(); // alert(\"Thank you for returning : \" + this.serial_number);\n\n\n            if (_this3.lang == \"thai\") {\n              document.getElementById(\"ScanSerial\").innerHTML = \"ขอบคุณ เชิญแสกนอุปกรณ์ถัดไป\";\n            } else {\n              document.getElementById(\"ScanSerial\").innerHTML = \"Thank you.Scan other item \";\n            }\n\n            _this3.door_close = 1;\n            _this3.serial_number = \"\";\n          }\n\n          console.log(detail.categories);\n        });\n      }\n    }, {\n      key: \"return\",\n      value: function _return() {\n        this.router.navigate(['/']);\n      }\n    }, {\n      key: \"tothai\",\n      value: function tothai() {\n        document.getElementById(\"ScanSerial\").innerHTML = \"แสกนบาร์โค๊ดบนอุปกรณ์เพื่อคืน\";\n      }\n    }, {\n      key: \"toeng\",\n      value: function toeng() {\n        document.getElementById(\"ScanSerial\").innerHTML = \"Scan barcore on item to return\";\n      }\n    }]);\n\n    return ReturnItemsComponent;\n  }();\n\n  ReturnItemsComponent.ɵfac = function ReturnItemsComponent_Factory(t) {\n    return new (t || ReturnItemsComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.HttpClient), i0.ɵɵdirectiveInject(i3.DataService));\n  };\n\n  ReturnItemsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ReturnItemsComponent,\n    selectors: [[\"app-return-items\"]],\n    hostBindings: function ReturnItemsComponent_HostBindings(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵlistener(\"keydown\", function ReturnItemsComponent_keydown_HostBindingHandler($event) {\n          return ctx.onkeydownHandler($event);\n        }, false, i0.ɵɵresolveDocument);\n      }\n    },\n    decls: 6,\n    vars: 0,\n    consts: [[1, \"container\"], [1, \"main\"], [\"src\", \"assets/barcode-scanner.png\", \"alt\", \"\", 1, \"image\"], [\"id\", \"ScanSerial\", 1, \"main-text\"], [\"id\", \"ScanSerial_sub\", 1, \"sub-text\"]],\n    template: function ReturnItemsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n        i0.ɵɵelement(2, \"img\", 2);\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵtext(4, \"Scan barcode on item to return \");\n        i0.ɵɵelement(5, \"div\", 4);\n        i0.ɵɵelementEnd()()();\n      }\n    },\n    styles: [\".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;color:#fff}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:absolute;top:0;width:100%;box-sizing:border-box;padding:1.5rem;display:flex;justify-content:space-between}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]{font-size:2rem;font-weight:300;letter-spacing:2px}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{float:right;display:flex;flex-direction:column;align-items:flex-end}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]{flex:1 1 auto;display:flex;align-items:center;justify-content:center}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .main-text[_ngcontent-%COMP%]{font-size:calc(.8em + 2vmin + 2vmax);font-weight:700}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .main-text[_ngcontent-%COMP%]   .sub-text[_ngcontent-%COMP%]{padding-top:1rem;font-size:calc(.4em + 1vmin + 1vmax);font-weight:400}.image[_ngcontent-%COMP%]{height:110px;margin:0 20px 20px 0}\"]\n  });\n  return ReturnItemsComponent;\n})();\nvar detail;","map":null,"metadata":{},"sourceType":"module"}